<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Омниборд — Delivery Metrics Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/recharts@2.10.3/umd/Recharts.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        
        :root {
            --bg-primary: #0a0a0b;
            --bg-secondary: #111113;
            --bg-tertiary: #18181b;
            --border: #27272a;
            --text-primary: #fafafa;
            --text-secondary: #a1a1aa;
            --text-muted: #71717a;
            --accent-green: #22c55e;
            --accent-red: #ef4444;
            --accent-yellow: #eab308;
            --accent-blue: #3b82f6;
            --accent-purple: #a855f7;
        }
        
        body {
            background: var(--bg-primary);
            color: var(--text-primary);
        }
        
        .glass {
            background: rgba(17, 17, 19, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
        }
        
        .glow-green { box-shadow: 0 0 20px rgba(34, 197, 94, 0.15); }
        .glow-red { box-shadow: 0 0 20px rgba(239, 68, 68, 0.15); }
        .glow-blue { box-shadow: 0 0 20px rgba(59, 130, 246, 0.15); }
        
        .gradient-mesh {
            background: 
                radial-gradient(at 0% 0%, rgba(34, 197, 94, 0.08) 0px, transparent 50%),
                radial-gradient(at 100% 0%, rgba(59, 130, 246, 0.08) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(168, 85, 247, 0.05) 0px, transparent 50%);
        }
        
        .sidebar-item {
            transition: all 0.2s ease;
        }
        .sidebar-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        .sidebar-item.active {
            background: rgba(34, 197, 94, 0.1);
            border-left: 2px solid var(--accent-green);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-in {
            animation: fadeIn 0.5s ease forwards;
        }
        
        .delay-1 { animation-delay: 0.1s; opacity: 0; }
        .delay-2 { animation-delay: 0.2s; opacity: 0; }
        .delay-3 { animation-delay: 0.3s; opacity: 0; }
        .delay-4 { animation-delay: 0.4s; opacity: 0; }
        
        .stat-card {
            position: relative;
            overflow: hidden;
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent-green), transparent);
            opacity: 0.5;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
        }
        
        .recharts-cartesian-grid-horizontal line,
        .recharts-cartesian-grid-vertical line {
            stroke: var(--border) !important;
        }
    </style>
</head>
<body class="min-h-screen gradient-mesh">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;
        const { 
            BarChart, Bar, LineChart, Line, XAxis, YAxis, CartesianGrid, 
            Tooltip, ResponsiveContainer, ReferenceLine, Area, AreaChart,
            Cell
        } = Recharts;

        // Mock Data
        const teams = [
            { id: 1, name: 'Web Production', platform: 'Web', key: 'WPROD' },
            { id: 2, name: 'Disrupt', platform: 'Web', key: 'DISRUPT' },
            { id: 3, name: 'Zvuk Client', platform: 'Backend', key: 'ZCL' },
            { id: 4, name: 'Zvuk iOS', platform: 'iOS', key: 'ZIOS' },
        ];

        const velocityData = [
            { sprint: 'S45', planned: 42, completed: 22, pct: 52 },
            { sprint: 'S46', planned: 38, completed: 26, pct: 68 },
            { sprint: 'S47', planned: 40, completed: 34, pct: 85 },
            { sprint: 'S48', planned: 45, completed: 32, pct: 72 },
            { sprint: 'S49', planned: 41, completed: 32, pct: 78 },
            { sprint: 'S50', planned: 43, completed: 35, pct: 81 },
        ];

        const cycleTimeData = [
            { week: 'W1', avg: 2.8, median: 2.1, p90: 5.2 },
            { week: 'W2', avg: 3.1, median: 2.4, p90: 6.1 },
            { week: 'W3', avg: 2.5, median: 1.9, p90: 4.8 },
            { week: 'W4', avg: 3.4, median: 2.8, p90: 6.8 },
            { week: 'W5', avg: 2.9, median: 2.2, p90: 5.5 },
            { week: 'W6', avg: 2.6, median: 2.0, p90: 4.9 },
            { week: 'W7', avg: 2.4, median: 1.8, p90: 4.5 },
            { week: 'W8', avg: 2.2, median: 1.7, p90: 4.2 },
        ];

        const dshbData = {
            baseline: 150,
            target: 135,
            current: 142,
            progressPct: 53.3,
            quarter: 'Q1 2025'
        };

        const summaryData = [
            { team: 'Web Production', velocity: 81, cycleTime: 3.2, dshb: -12, trend: 'up' },
            { team: 'Disrupt', velocity: 85, cycleTime: 2.1, dshb: -18, trend: 'up' },
            { team: 'Zvuk Client', velocity: 72, cycleTime: 3.8, dshb: -8, trend: 'stable' },
            { team: 'Zvuk iOS', velocity: 68, cycleTime: 4.1, dshb: -5, trend: 'down' },
        ];

        const platforms = ['Все', 'iOS', 'Android', 'Backend', 'Web', 'DE', 'DS'];

        // Components
        const Logo = () => (
            <div className="flex items-center gap-3 px-4 py-5 border-b border-zinc-800">
                <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-green-500 to-blue-500 flex items-center justify-center">
                    <span className="text-white font-bold text-sm">О</span>
                </div>
                <div>
                    <div className="font-semibold text-white">ОМНИБОРД</div>
                    <div className="text-xs text-zinc-500 mono">Delivery Metrics</div>
                </div>
            </div>
        );

        const Sidebar = ({ selectedPlatform, setSelectedPlatform, selectedTeam, setSelectedTeam }) => (
            <aside className="w-64 h-screen glass fixed left-0 top-0 flex flex-col">
                <Logo />
                
                <div className="p-4">
                    <div className="text-xs font-medium text-zinc-500 uppercase tracking-wider mb-3">Платформа</div>
                    <div className="space-y-1">
                        {platforms.map(p => (
                            <button
                                key={p}
                                onClick={() => setSelectedPlatform(p)}
                                className={`w-full text-left px-3 py-2 rounded-lg text-sm transition-all ${
                                    selectedPlatform === p 
                                        ? 'bg-green-500/10 text-green-400 border-l-2 border-green-500' 
                                        : 'text-zinc-400 hover:text-white hover:bg-zinc-800/50'
                                }`}
                            >
                                {p}
                            </button>
                        ))}
                    </div>
                </div>
                
                <div className="p-4 flex-1 overflow-auto">
                    <div className="text-xs font-medium text-zinc-500 uppercase tracking-wider mb-3">Команды</div>
                    <div className="relative mb-3">
                        <input 
                            type="text" 
                            placeholder="Поиск..."
                            className="w-full bg-zinc-900 border border-zinc-800 rounded-lg px-3 py-2 text-sm text-white placeholder-zinc-600 focus:outline-none focus:border-zinc-700"
                        />
                        <svg className="absolute right-3 top-2.5 w-4 h-4 text-zinc-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                    <div className="space-y-1">
                        {teams
                            .filter(t => selectedPlatform === 'Все' || t.platform === selectedPlatform)
                            .map(team => (
                            <button
                                key={team.id}
                                onClick={() => setSelectedTeam(team)}
                                className={`w-full text-left px-3 py-2 rounded-lg text-sm transition-all ${
                                    selectedTeam?.id === team.id 
                                        ? 'bg-blue-500/10 text-blue-400' 
                                        : 'text-zinc-400 hover:text-white hover:bg-zinc-800/50'
                                }`}
                            >
                                <div className="flex items-center justify-between">
                                    <span>{team.name}</span>
                                    <span className="text-xs text-zinc-600 mono">{team.key}</span>
                                </div>
                            </button>
                        ))}
                    </div>
                </div>
                
                <div className="p-4 border-t border-zinc-800">
                    <div className="text-xs font-medium text-zinc-500 uppercase tracking-wider mb-3">Admin</div>
                    <button className="w-full flex items-center gap-2 px-3 py-2 text-sm text-zinc-400 hover:text-white hover:bg-zinc-800/50 rounded-lg transition-all">
                        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                        Синхронизация
                    </button>
                </div>
            </aside>
        );

        const StatCard = ({ title, value, subtitle, trend, color = 'green' }) => {
            const colorClasses = {
                green: 'border-green-500/20 before:bg-gradient-to-r before:from-transparent before:via-green-500 before:to-transparent',
                blue: 'border-blue-500/20 before:bg-gradient-to-r before:from-transparent before:via-blue-500 before:to-transparent',
                purple: 'border-purple-500/20 before:bg-gradient-to-r before:from-transparent before:via-purple-500 before:to-transparent',
            };
            
            return (
                <div className={`stat-card glass rounded-xl p-5 ${colorClasses[color]}`}>
                    <div className="text-xs font-medium text-zinc-500 uppercase tracking-wider mb-2">{title}</div>
                    <div className="flex items-end gap-2">
                        <span className="text-3xl font-bold mono">{value}</span>
                        {trend && (
                            <span className={`text-sm font-medium ${trend > 0 ? 'text-green-400' : 'text-red-400'}`}>
                                {trend > 0 ? '↗' : '↘'} {Math.abs(trend)}%
                            </span>
                        )}
                    </div>
                    {subtitle && <div className="text-sm text-zinc-500 mt-1">{subtitle}</div>}
                </div>
            );
        };

        const VelocityChart = ({ data }) => (
            <div className="glass rounded-xl p-5 animate-in delay-1">
                <div className="flex items-center justify-between mb-4">
                    <div>
                        <h3 className="font-semibold text-white">Velocity</h3>
                        <p className="text-sm text-zinc-500">Последние 6 спринтов</p>
                    </div>
                    <div className="flex items-center gap-4 text-xs">
                        <div className="flex items-center gap-2">
                            <div className="w-3 h-3 rounded bg-green-500"></div>
                            <span className="text-zinc-400">Completed SP</span>
                        </div>
                        <div className="flex items-center gap-2">
                            <div className="w-3 h-3 rounded bg-zinc-700"></div>
                            <span className="text-zinc-400">Planned SP</span>
                        </div>
                    </div>
                </div>
                <ResponsiveContainer width="100%" height={240}>
                    <BarChart data={data} barGap={4}>
                        <CartesianGrid strokeDasharray="3 3" stroke="#27272a" vertical={false} />
                        <XAxis dataKey="sprint" tick={{ fill: '#71717a', fontSize: 12 }} axisLine={false} tickLine={false} />
                        <YAxis tick={{ fill: '#71717a', fontSize: 12 }} axisLine={false} tickLine={false} />
                        <Tooltip 
                            contentStyle={{ 
                                background: '#18181b', 
                                border: '1px solid #27272a', 
                                borderRadius: '8px',
                                boxShadow: '0 4px 20px rgba(0,0,0,0.5)'
                            }}
                            labelStyle={{ color: '#fafafa' }}
                        />
                        <ReferenceLine y={60} stroke="#eab308" strokeDasharray="5 5" label={{ value: 'Target 60%', fill: '#eab308', fontSize: 11 }} />
                        <Bar dataKey="planned" fill="#3f3f46" radius={[4, 4, 0, 0]} />
                        <Bar dataKey="completed" radius={[4, 4, 0, 0]}>
                            {data.map((entry, index) => (
                                <Cell key={index} fill={entry.pct >= 60 ? '#22c55e' : '#ef4444'} />
                            ))}
                        </Bar>
                    </BarChart>
                </ResponsiveContainer>
                <div className="flex justify-center gap-4 mt-2">
                    {data.map((d, i) => (
                        <div key={i} className="text-center">
                            <div className={`text-xs font-medium mono ${d.pct >= 60 ? 'text-green-400' : 'text-red-400'}`}>
                                {d.pct}%
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );

        const CycleTimeChart = ({ data }) => (
            <div className="glass rounded-xl p-5 animate-in delay-2">
                <div className="flex items-center justify-between mb-4">
                    <div>
                        <h3 className="font-semibold text-white">Cycle Time</h3>
                        <p className="text-sm text-zinc-500">Последние 8 недель (дни)</p>
                    </div>
                    <div className="flex items-center gap-4 text-xs">
                        <div className="flex items-center gap-2">
                            <div className="w-3 h-3 rounded bg-purple-500"></div>
                            <span className="text-zinc-400">P90</span>
                        </div>
                        <div className="flex items-center gap-2">
                            <div className="w-3 h-3 rounded bg-blue-500"></div>
                            <span className="text-zinc-400">Median</span>
                        </div>
                        <div className="flex items-center gap-2">
                            <div className="w-3 h-3 rounded bg-green-500"></div>
                            <span className="text-zinc-400">Avg</span>
                        </div>
                    </div>
                </div>
                <ResponsiveContainer width="100%" height={240}>
                    <AreaChart data={data}>
                        <defs>
                            <linearGradient id="colorP90" x1="0" y1="0" x2="0" y2="1">
                                <stop offset="5%" stopColor="#a855f7" stopOpacity={0.3}/>
                                <stop offset="95%" stopColor="#a855f7" stopOpacity={0}/>
                            </linearGradient>
                        </defs>
                        <CartesianGrid strokeDasharray="3 3" stroke="#27272a" vertical={false} />
                        <XAxis dataKey="week" tick={{ fill: '#71717a', fontSize: 12 }} axisLine={false} tickLine={false} />
                        <YAxis tick={{ fill: '#71717a', fontSize: 12 }} axisLine={false} tickLine={false} domain={[0, 8]} />
                        <Tooltip 
                            contentStyle={{ 
                                background: '#18181b', 
                                border: '1px solid #27272a', 
                                borderRadius: '8px',
                                boxShadow: '0 4px 20px rgba(0,0,0,0.5)'
                            }}
                            labelStyle={{ color: '#fafafa' }}
                        />
                        <Area type="monotone" dataKey="p90" stroke="#a855f7" fill="url(#colorP90)" strokeWidth={2} />
                        <Line type="monotone" dataKey="median" stroke="#3b82f6" strokeWidth={2} dot={{ fill: '#3b82f6', strokeWidth: 0, r: 3 }} />
                        <Line type="monotone" dataKey="avg" stroke="#22c55e" strokeWidth={2} dot={{ fill: '#22c55e', strokeWidth: 0, r: 3 }} />
                    </AreaChart>
                </ResponsiveContainer>
            </div>
        );

        const DshbWidget = ({ data }) => {
            const progress = ((data.baseline - data.current) / (data.baseline - data.target)) * 100;
            
            return (
                <div className="glass rounded-xl p-5 animate-in delay-3">
                    <div className="flex items-center justify-between mb-4">
                        <div>
                            <h3 className="font-semibold text-white">ДШБ</h3>
                            <p className="text-sm text-zinc-500">{data.quarter} • Динамическая шкала багов</p>
                        </div>
                        <div className={`px-3 py-1 rounded-full text-xs font-medium ${
                            progress >= 50 ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'
                        }`}>
                            {progress >= 50 ? 'On Track' : 'At Risk'}
                        </div>
                    </div>
                    
                    <div className="grid grid-cols-3 gap-4 mb-6">
                        <div className="text-center">
                            <div className="text-2xl font-bold mono text-zinc-400">{data.baseline}</div>
                            <div className="text-xs text-zinc-600">Baseline</div>
                        </div>
                        <div className="text-center">
                            <div className="text-2xl font-bold mono text-blue-400">{data.current}</div>
                            <div className="text-xs text-zinc-600">Current</div>
                        </div>
                        <div className="text-center">
                            <div className="text-2xl font-bold mono text-green-400">{data.target}</div>
                            <div className="text-xs text-zinc-600">Target</div>
                        </div>
                    </div>
                    
                    <div className="mb-2">
                        <div className="flex justify-between text-xs text-zinc-500 mb-1">
                            <span>Progress</span>
                            <span className="mono">{progress.toFixed(1)}%</span>
                        </div>
                        <div className="h-3 bg-zinc-800 rounded-full overflow-hidden">
                            <div 
                                className="h-full progress-bar rounded-full transition-all duration-1000"
                                style={{ width: `${Math.min(progress, 100)}%` }}
                            ></div>
                        </div>
                    </div>
                    
                    <div className="flex items-center justify-between text-xs text-zinc-500 mt-4">
                        <span>Сокращено: <span className="text-green-400 font-medium">{data.baseline - data.current}</span> багов</span>
                        <span>Осталось: <span className="text-yellow-400 font-medium">{data.current - data.target}</span> багов</span>
                    </div>
                </div>
            );
        };

        const SummaryTable = ({ data }) => (
            <div className="glass rounded-xl p-5 animate-in delay-4">
                <div className="flex items-center justify-between mb-4">
                    <div>
                        <h3 className="font-semibold text-white">Сводка по командам</h3>
                        <p className="text-sm text-zinc-500">Все команды</p>
                    </div>
                </div>
                <div className="overflow-x-auto">
                    <table className="w-full">
                        <thead>
                            <tr className="text-xs text-zinc-500 uppercase tracking-wider">
                                <th className="text-left py-3 px-2">Команда</th>
                                <th className="text-right py-3 px-2">Velocity</th>
                                <th className="text-right py-3 px-2">Cycle Time</th>
                                <th className="text-right py-3 px-2">ДШБ</th>
                                <th className="text-right py-3 px-2">Trend</th>
                            </tr>
                        </thead>
                        <tbody>
                            {data.map((row, i) => (
                                <tr key={i} className="border-t border-zinc-800 hover:bg-zinc-800/30 transition-colors">
                                    <td className="py-3 px-2 font-medium">{row.team}</td>
                                    <td className="text-right py-3 px-2">
                                        <span className={`mono ${row.velocity >= 60 ? 'text-green-400' : 'text-red-400'}`}>
                                            {row.velocity}%
                                        </span>
                                    </td>
                                    <td className="text-right py-3 px-2">
                                        <span className="mono text-blue-400">{row.cycleTime}d</span>
                                    </td>
                                    <td className="text-right py-3 px-2">
                                        <span className="mono text-green-400">{row.dshb}%</span>
                                    </td>
                                    <td className="text-right py-3 px-2">
                                        <span className={`text-lg ${
                                            row.trend === 'up' ? 'text-green-400' : 
                                            row.trend === 'down' ? 'text-red-400' : 'text-zinc-500'
                                        }`}>
                                            {row.trend === 'up' ? '↗' : row.trend === 'down' ? '↘' : '→'}
                                        </span>
                                    </td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            </div>
        );

        const Header = ({ selectedTeam }) => (
            <header className="flex items-center justify-between mb-6">
                <div>
                    {selectedTeam ? (
                        <>
                            <div className="flex items-center gap-2 text-sm text-zinc-500 mb-1">
                                <button className="hover:text-white transition-colors">← Dashboard</button>
                            </div>
                            <h1 className="text-2xl font-bold">{selectedTeam.name}</h1>
                            <div className="flex items-center gap-3 mt-1">
                                <span className="text-sm text-zinc-500 mono">{selectedTeam.key}</span>
                                <span className="px-2 py-0.5 bg-zinc-800 rounded text-xs text-zinc-400">{selectedTeam.platform}</span>
                            </div>
                        </>
                    ) : (
                        <>
                            <h1 className="text-2xl font-bold">Dashboard</h1>
                            <p className="text-zinc-500">Обзор всех команд</p>
                        </>
                    )}
                </div>
                <div className="flex items-center gap-4">
                    <div className="text-right">
                        <div className="text-xs text-zinc-500">Последнее обновление</div>
                        <div className="text-sm mono text-zinc-400">29.01.2026, 02:15</div>
                    </div>
                    <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                </div>
            </header>
        );

        const App = () => {
            const [selectedPlatform, setSelectedPlatform] = useState('Все');
            const [selectedTeam, setSelectedTeam] = useState(teams[1]); // Disrupt
            
            const avgVelocity = Math.round(velocityData.reduce((a, b) => a + b.pct, 0) / velocityData.length);
            const avgCycleTime = (cycleTimeData.reduce((a, b) => a + b.avg, 0) / cycleTimeData.length).toFixed(1);
            
            return (
                <div className="flex">
                    <Sidebar 
                        selectedPlatform={selectedPlatform}
                        setSelectedPlatform={setSelectedPlatform}
                        selectedTeam={selectedTeam}
                        setSelectedTeam={setSelectedTeam}
                    />
                    
                    <main className="flex-1 ml-64 p-8">
                        <Header selectedTeam={selectedTeam} />
                        
                        {/* Stats Row */}
                        <div className="grid grid-cols-4 gap-4 mb-6">
                            <StatCard 
                                title="Avg Velocity" 
                                value={`${avgVelocity}%`}
                                subtitle="Target: 60%"
                                trend={5}
                                color="green"
                            />
                            <StatCard 
                                title="Avg Cycle Time" 
                                value={`${avgCycleTime}d`}
                                subtitle="Median: 2.0d"
                                trend={-8}
                                color="blue"
                            />
                            <StatCard 
                                title="ДШБ Progress" 
                                value={`${dshbData.progressPct}%`}
                                subtitle={`${dshbData.current} / ${dshbData.target} багов`}
                                color="purple"
                            />
                            <StatCard 
                                title="Teams" 
                                value={teams.length}
                                subtitle="активных"
                                color="blue"
                            />
                        </div>
                        
                        {/* Charts Row 1 */}
                        <div className="grid grid-cols-2 gap-6 mb-6">
                            <VelocityChart data={velocityData} />
                            <CycleTimeChart data={cycleTimeData} />
                        </div>
                        
                        {/* Charts Row 2 */}
                        <div className="grid grid-cols-3 gap-6">
                            <DshbWidget data={dshbData} />
                            <div className="col-span-2">
                                <SummaryTable data={summaryData} />
                            </div>
                        </div>
                        
                        {/* Footer */}
                        <footer className="mt-8 pt-6 border-t border-zinc-800 text-center text-xs text-zinc-600">
                            <span className="mono">ОМНИБОРД v1.0</span> • Delivery Metrics Dashboard • 
                            <span className="text-green-500 ml-1">● VPN Connected</span>
                        </footer>
                    </main>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
